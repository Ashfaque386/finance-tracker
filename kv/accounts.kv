#:kivy 2.0

<AccountsScreen>:
    name: 'accounts'
    
    MDBoxLayout:
        orientation: 'vertical'
        
        MDTopAppBar:
            title: "Accounts"
            md_bg_color: app.theme_cls.primary_color
            specific_text_color: 1, 1, 1, 1
            left_action_items: [["arrow-left", lambda x: setattr(root.manager, 'current', 'dashboard')]]
        
        ScrollView:
            MDBoxLayout:
                orientation: 'vertical'
                padding: dp(16)
                spacing: dp(16)
                size_hint_y: None
                height: self.minimum_height
                
                # Total Balance Card
                MDCard:
                    size_hint_y: None
                    height: dp(120)
                    elevation: 3
                    padding: dp(20)
                    md_bg_color: app.theme_cls.primary_color
                    
                    MDBoxLayout:
                        orientation: 'vertical'
                        
                        MDLabel:
                            text: "Total Balance"
                            font_style: "H6"
                            size_hint_y: 0.4
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 0.8
                        
                        MDLabel:
                            id: total_balance
                            text: "$0.00"
                            font_style: "H3"
                            bold: True
                            size_hint_y: 0.6
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                
                # Accounts List Header
                MDBoxLayout:
                    size_hint_y: None
                    height: dp(40)
                    
                    MDLabel:
                        text: "All Accounts"
                        font_style: "H6"
                        bold: True
                    
                    Widget:
                    
                    MDIconButton:
                        icon: "plus-circle"
                        theme_text_color: "Custom"
                        text_color: app.theme_cls.primary_color
                        on_release: root.add_account()
                
                # Accounts List
                MDBoxLayout:
                    id: accounts_container
                    orientation: 'vertical'
                    spacing: dp(12)
                    size_hint_y: None
                    height: self.minimum_height


<AccountCard@MDCard>:
    account_id: 0
    account_name: ""
    account_type: ""
    balance: 0.0
    icon: "wallet"
    color: "#2196F3"
    
    size_hint_y: None
    height: dp(100)
    elevation: 2
    padding: dp(16)
    on_release: root.show_account_details()
    
    MDBoxLayout:
        orientation: 'horizontal'
        spacing: dp(16)
        
        MDIcon:
            icon: root.icon
            size_hint_x: None
            width: dp(40)
            theme_text_color: "Custom"
            text_color: root.color
        
        MDBoxLayout:
            orientation: 'vertical'
            
            MDLabel:
                text: root.account_name
                font_style: "H6"
                bold: True
                size_hint_y: 0.5
            
            MDLabel:
                text: root.account_type
                font_style: "Caption"
                size_hint_y: 0.5
        
        Widget:
        
        MDLabel:
            text: f"${root.balance:.2f}"
            font_style: "H5"
            bold: True
            size_hint_x: None
            width: self.texture_size[0]
            theme_text_color: "Custom"
            text_color: 0.3, 0.7, 0.3, 1 if root.balance >= 0 else 0.9, 0.2, 0.2, 1
        
        MDIconButton:
            icon: "dots-vertical"
            size_hint_x: None
            width: dp(40)
            on_release: root.show_options()


<AccountFormDialog>:
    size_hint: 0.9, None
    height: dp(500)
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(15)
        
        MDLabel:
            text: "Add Account"
            font_style: "H5"
            bold: True
            size_hint_y: None
            height: dp(40)
        
        MDTextField:
            id: account_name
            hint_text: "Account Name"
            required: True
        
        MDTextField:
            id: account_type
            hint_text: "Account Type (Cash, Bank, Card, etc.)"
        
        MDTextField:
            id: initial_balance
            hint_text: "Initial Balance"
            input_filter: "float"
        
        MDTextField:
            id: currency
            hint_text: "Currency (USD, EUR, etc.)"
            text: "USD"
        
        MDBoxLayout:
            size_hint_y: None
            height: dp(50)
            
            MDLabel:
                text: "Credit Card?"
                size_hint_x: 0.5
            
            MDSwitch:
                id: is_credit_card
                size_hint_x: 0.5
        
        MDTextField:
            id: notes
            hint_text: "Notes (optional)"
            multiline: True
            max_height: dp(80)
        
        MDBoxLayout:
            size_hint_y: None
            height: dp(50)
            spacing: dp(10)
            
            MDFlatButton:
                text: "Cancel"
                on_release: root.dismiss()
            
            Widget:
            
            MDRaisedButton:
                text: "Save"
                md_bg_color: app.theme_cls.primary_color
                on_release: root.save_account()

